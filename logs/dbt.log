

============================== 2022-10-26 09:29:59.433358 | 75ca5e95-2a8f-469e-8dcc-1a580a7e827a ==============================
[0m09:29:59.433358 [info ] [MainThread]: Running with dbt=1.3.0
[0m09:30:11.761833 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m09:30:11.762750 [debug] [MainThread]: Tracking: tracking
[0m09:30:11.787351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFB5F55DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFB5F8A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DFB5F89720>]}
[0m09:30:11.789998 [debug] [MainThread]: Flushing usage events


============================== 2022-10-26 09:32:08.768390 | e4422db8-d8da-490d-b969-4fb1f2d07ec9 ==============================
[0m09:32:08.768390 [info ] [MainThread]: Running with dbt=1.3.0
[0m09:32:08.769388 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
[0m09:32:08.769388 [debug] [MainThread]: Tracking: tracking
[0m09:32:08.789608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A323BD5D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A323C0A260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A323C096F0>]}
[0m09:32:34.962345 [debug] [MainThread]: Starter project path: C:\Users\User\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\include\starter_project
[0m09:32:56.524090 [info ] [MainThread]: 
Your new dbt project "demo_dbt" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m09:32:56.526048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A323BD6F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A323BD7BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A323BD6410>]}
[0m09:32:56.527030 [debug] [MainThread]: Flushing usage events


============================== 2022-10-26 09:43:09.672803 | 130384b9-033e-49d1-8c16-1fef87f26789 ==============================
[0m09:43:09.672803 [info ] [MainThread]: Running with dbt=1.3.0
[0m09:43:09.673792 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m09:43:09.673792 [debug] [MainThread]: Tracking: tracking
[0m09:43:09.695376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE69637190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE69635ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE6966A380>]}
[0m09:43:09.744373 [debug] [MainThread]: Executing "git --help"
[0m09:43:09.813861 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:43:09.814361 [debug] [MainThread]: STDERR: "b''"
[0m09:43:09.815376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE69635CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE69668D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE696681C0>]}
[0m09:43:09.816375 [debug] [MainThread]: Flushing usage events


============================== 2022-10-26 10:36:53.180334 | af987b34-0044-42af-842a-3c97c20bdb51 ==============================
[0m10:36:53.180334 [info ] [MainThread]: Running with dbt=1.3.0
[0m10:36:53.181331 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:36:53.182382 [debug] [MainThread]: Tracking: tracking
[0m10:36:53.210416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656AC313F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656AC31DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656AC31360>]}
[0m10:36:53.314291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m10:36:53.314792 [debug] [MainThread]: Partial parsing: added file: demo_dbt://models\pg_sample_data\pg_samole_data_mes.sql
[0m10:36:53.315292 [debug] [MainThread]: Partial parsing: added file: demo_dbt://models\pg_sample_data\schema.yml
[0m10:36:53.330609 [debug] [MainThread]: 1603: static parser failed on pg_sample_data\pg_samole_data_mes.sql
[0m10:36:53.336619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656AD91330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656ADBD3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656ADC9180>]}
[0m10:36:53.336619 [debug] [MainThread]: Flushing usage events
[0m10:36:54.205241 [error] [MainThread]: Encountered an error:
Compilation Error in model pg_samole_data_mes (models\pg_sample_data\pg_samole_data_mes.sql)
  The source name (first) argument to source() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>


============================== 2022-10-26 10:37:31.083658 | 3240597d-e818-4ec0-bc38-7277924bc5e9 ==============================
[0m10:37:31.083658 [info ] [MainThread]: Running with dbt=1.3.0
[0m10:37:31.084796 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:37:31.085171 [debug] [MainThread]: Tracking: tracking
[0m10:37:31.115313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029298D6D3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029298D6DDB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029298D6D360>]}
[0m10:37:31.170409 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m10:37:31.170409 [debug] [MainThread]: Partial parsing: added file: demo_dbt://models\pg_sample_data\schema.yml
[0m10:37:31.171337 [debug] [MainThread]: Partial parsing: added file: demo_dbt://models\pg_sample_data\pg_samole_data_mes.sql
[0m10:37:31.181368 [debug] [MainThread]: 1699: static parser successfully parsed pg_sample_data\pg_samole_data_mes.sql
[0m10:37:31.244062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3240597d-e818-4ec0-bc38-7277924bc5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029298E9B040>]}
[0m10:37:31.249974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3240597d-e818-4ec0-bc38-7277924bc5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029298EB7F40>]}
[0m10:37:31.250973 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:37:31.250973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3240597d-e818-4ec0-bc38-7277924bc5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029296A06F50>]}
[0m10:37:31.253049 [info ] [MainThread]: 
[0m10:37:31.253855 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:37:31.255862 [debug] [ThreadPool]: Acquiring new postgres connection "list_stage"
[0m10:37:31.265155 [debug] [ThreadPool]: Using postgres connection "list_stage"
[0m10:37:31.265155 [debug] [ThreadPool]: On list_stage: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "list_stage"} */

    select distinct nspname from pg_namespace
  
[0m10:37:31.266159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:31.361040 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.09 seconds
[0m10:37:31.362187 [debug] [ThreadPool]: On list_stage: Close
[0m10:37:31.363777 [debug] [ThreadPool]: Acquiring new postgres connection "list_stage_mes"
[0m10:37:31.369444 [debug] [ThreadPool]: Using postgres connection "list_stage_mes"
[0m10:37:31.369961 [debug] [ThreadPool]: On list_stage_mes: BEGIN
[0m10:37:31.369961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:31.426470 [debug] [ThreadPool]: SQL status: BEGIN in 0.06 seconds
[0m10:37:31.426970 [debug] [ThreadPool]: Using postgres connection "list_stage_mes"
[0m10:37:31.426970 [debug] [ThreadPool]: On list_stage_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "list_stage_mes"} */
select
      'stage' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mes'
    union all
    select
      'stage' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mes'
  
[0m10:37:31.449438 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
[0m10:37:31.451052 [debug] [ThreadPool]: On list_stage_mes: ROLLBACK
[0m10:37:31.452623 [debug] [ThreadPool]: On list_stage_mes: Close
[0m10:37:31.456512 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:31.457238 [debug] [MainThread]: On master: BEGIN
[0m10:37:31.457527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:37:31.496486 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m10:37:31.497007 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:31.497007 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:37:31.515440 [debug] [MainThread]: SQL status: SELECT 1 in 0.02 seconds
[0m10:37:31.516539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3240597d-e818-4ec0-bc38-7277924bc5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029298F8A8C0>]}
[0m10:37:31.517104 [debug] [MainThread]: On master: ROLLBACK
[0m10:37:31.518197 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:31.518697 [debug] [MainThread]: On master: BEGIN
[0m10:37:31.520697 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:37:31.521201 [debug] [MainThread]: On master: COMMIT
[0m10:37:31.521698 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:31.521698 [debug] [MainThread]: On master: COMMIT
[0m10:37:31.522698 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:37:31.522698 [debug] [MainThread]: On master: Close
[0m10:37:31.523699 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:37:31.524197 [info ] [MainThread]: 
[0m10:37:31.531698 [debug] [Thread-1 (]: Began running node model.demo_dbt.my_first_dbt_model
[0m10:37:31.531698 [info ] [Thread-1 (]: 1 of 3 START sql table model mes.my_first_dbt_model ............................ [RUN]
[0m10:37:31.532698 [debug] [Thread-1 (]: Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model"
[0m10:37:31.532698 [debug] [Thread-1 (]: Began compiling node model.demo_dbt.my_first_dbt_model
[0m10:37:31.533198 [debug] [Thread-1 (]: Compiling model.demo_dbt.my_first_dbt_model
[0m10:37:31.535716 [debug] [Thread-1 (]: Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
[0m10:37:31.537197 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:31.537197 [debug] [Thread-1 (]: Began executing node model.demo_dbt.my_first_dbt_model
[0m10:37:31.568601 [debug] [Thread-1 (]: Writing runtime sql for node "model.demo_dbt.my_first_dbt_model"
[0m10:37:31.570509 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m10:37:31.570509 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: BEGIN
[0m10:37:31.571541 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:37:31.618215 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m10:37:31.618742 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m10:37:31.619268 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */

  
    

  create  table "stage"."mes"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:37:31.640970 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.02 seconds
[0m10:37:31.647632 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m10:37:31.648117 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "stage"."mes"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:37:31.650114 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:31.652615 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m10:37:31.652615 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "stage"."mes"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:37:31.654117 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:31.674080 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: COMMIT
[0m10:37:31.675054 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m10:37:31.675054 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: COMMIT
[0m10:37:31.688342 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m10:37:31.692693 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m10:37:31.693243 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "stage"."mes"."my_first_dbt_model__dbt_backup" cascade
[0m10:37:31.738348 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.05 seconds
[0m10:37:31.739433 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:31.740000 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: Close
[0m10:37:31.740520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3240597d-e818-4ec0-bc38-7277924bc5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292990427A0>]}
[0m10:37:31.741047 [info ] [Thread-1 (]: 1 of 3 OK created sql table model mes.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.21s]
[0m10:37:31.741562 [debug] [Thread-1 (]: Finished running node model.demo_dbt.my_first_dbt_model
[0m10:37:31.742076 [debug] [Thread-1 (]: Began running node model.demo_dbt.pg_samole_data_mes
[0m10:37:31.742598 [info ] [Thread-1 (]: 2 of 3 START sql view model mes.pg_samole_data_mes ............................. [RUN]
[0m10:37:31.743490 [debug] [Thread-1 (]: Acquiring new postgres connection "model.demo_dbt.pg_samole_data_mes"
[0m10:37:31.744315 [debug] [Thread-1 (]: Began compiling node model.demo_dbt.pg_samole_data_mes
[0m10:37:31.744491 [debug] [Thread-1 (]: Compiling model.demo_dbt.pg_samole_data_mes
[0m10:37:31.747492 [debug] [Thread-1 (]: Writing injected SQL for node "model.demo_dbt.pg_samole_data_mes"
[0m10:37:31.748491 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:31.748994 [debug] [Thread-1 (]: Began executing node model.demo_dbt.pg_samole_data_mes
[0m10:37:31.764002 [debug] [Thread-1 (]: Writing runtime sql for node "model.demo_dbt.pg_samole_data_mes"
[0m10:37:31.765114 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_samole_data_mes"
[0m10:37:31.765614 [debug] [Thread-1 (]: On model.demo_dbt.pg_samole_data_mes: BEGIN
[0m10:37:31.765614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:31.806530 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m10:37:31.807051 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_samole_data_mes"
[0m10:37:31.807567 [debug] [Thread-1 (]: On model.demo_dbt.pg_samole_data_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.pg_samole_data_mes"} */

  create view "stage"."mes"."pg_samole_data_mes__dbt_tmp" as (
    with dataserver_data as (
    select * from "stage"."mes"."dataserver_data"
),

final as (
select * from dataserver_data
)

select * from final
  );
[0m10:37:31.819209 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m10:37:31.821931 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_samole_data_mes"
[0m10:37:31.821931 [debug] [Thread-1 (]: On model.demo_dbt.pg_samole_data_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.pg_samole_data_mes"} */
alter table "stage"."mes"."pg_samole_data_mes__dbt_tmp" rename to "pg_samole_data_mes"
[0m10:37:31.823499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:31.825100 [debug] [Thread-1 (]: On model.demo_dbt.pg_samole_data_mes: COMMIT
[0m10:37:31.825100 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_samole_data_mes"
[0m10:37:31.825100 [debug] [Thread-1 (]: On model.demo_dbt.pg_samole_data_mes: COMMIT
[0m10:37:31.828858 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:37:31.830994 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_samole_data_mes"
[0m10:37:31.830994 [debug] [Thread-1 (]: On model.demo_dbt.pg_samole_data_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.pg_samole_data_mes"} */
drop view if exists "stage"."mes"."pg_samole_data_mes__dbt_backup" cascade
[0m10:37:31.832561 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:37:31.833629 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:31.834142 [debug] [Thread-1 (]: On model.demo_dbt.pg_samole_data_mes: Close
[0m10:37:31.834663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3240597d-e818-4ec0-bc38-7277924bc5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029298FEF280>]}
[0m10:37:31.835167 [info ] [Thread-1 (]: 2 of 3 OK created sql view model mes.pg_samole_data_mes ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m10:37:31.836237 [debug] [Thread-1 (]: Finished running node model.demo_dbt.pg_samole_data_mes
[0m10:37:31.836237 [debug] [Thread-1 (]: Began running node model.demo_dbt.my_second_dbt_model
[0m10:37:31.836758 [info ] [Thread-1 (]: 3 of 3 START sql view model mes.my_second_dbt_model ............................ [RUN]
[0m10:37:31.837806 [debug] [Thread-1 (]: Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model"
[0m10:37:31.837806 [debug] [Thread-1 (]: Began compiling node model.demo_dbt.my_second_dbt_model
[0m10:37:31.838468 [debug] [Thread-1 (]: Compiling model.demo_dbt.my_second_dbt_model
[0m10:37:31.840956 [debug] [Thread-1 (]: Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
[0m10:37:31.841960 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:31.841960 [debug] [Thread-1 (]: Began executing node model.demo_dbt.my_second_dbt_model
[0m10:37:31.845473 [debug] [Thread-1 (]: Writing runtime sql for node "model.demo_dbt.my_second_dbt_model"
[0m10:37:31.845973 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m10:37:31.847047 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: BEGIN
[0m10:37:31.847047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:31.882826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m10:37:31.883344 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m10:37:31.883344 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "stage"."mes"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "stage"."mes"."my_first_dbt_model"
where id = 1
  );
[0m10:37:31.889823 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m10:37:31.892325 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m10:37:31.892842 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "stage"."mes"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:37:31.894825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:31.896824 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: COMMIT
[0m10:37:31.897324 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m10:37:31.897324 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: COMMIT
[0m10:37:31.899824 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:37:31.903324 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m10:37:31.903324 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "stage"."mes"."my_second_dbt_model__dbt_backup" cascade
[0m10:37:31.904825 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:37:31.906326 [debug] [Thread-1 (]: finished collecting timing info
[0m10:37:31.906326 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: Close
[0m10:37:31.906823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3240597d-e818-4ec0-bc38-7277924bc5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292990BC580>]}
[0m10:37:31.907324 [info ] [Thread-1 (]: 3 of 3 OK created sql view model mes.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.07s]
[0m10:37:31.908328 [debug] [Thread-1 (]: Finished running node model.demo_dbt.my_second_dbt_model
[0m10:37:31.909323 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:37:31.910325 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:31.910824 [debug] [MainThread]: On master: BEGIN
[0m10:37:31.911420 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:37:31.938265 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m10:37:31.938790 [debug] [MainThread]: On master: COMMIT
[0m10:37:31.939310 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:31.939310 [debug] [MainThread]: On master: COMMIT
[0m10:37:31.940353 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:37:31.940353 [debug] [MainThread]: On master: Close
[0m10:37:31.940874 [info ] [MainThread]: 
[0m10:37:31.941918 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m10:37:31.942446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:37:31.942446 [debug] [MainThread]: Connection 'list_stage' was properly closed.
[0m10:37:31.942980 [debug] [MainThread]: Connection 'list_stage_mes' was properly closed.
[0m10:37:31.942980 [debug] [MainThread]: Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
[0m10:37:31.948977 [info ] [MainThread]: 
[0m10:37:31.949477 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:37:31.949977 [info ] [MainThread]: 
[0m10:37:31.950978 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:37:31.951477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292990BC670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292990B0E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292990B2560>]}
[0m10:37:31.951477 [debug] [MainThread]: Flushing usage events


============================== 2022-10-26 10:38:32.014242 | eefa341a-61c3-4396-be0b-0ca9ef9fbb82 ==============================
[0m10:38:32.014242 [info ] [MainThread]: Running with dbt=1.3.0
[0m10:38:32.016241 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m10:38:32.016241 [debug] [MainThread]: Tracking: tracking
[0m10:38:32.049358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C10EFF13F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C10EFF1DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C10EFF1360>]}
[0m10:38:32.138813 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m10:38:32.138813 [debug] [MainThread]: Partial parsing: added file: demo_dbt://models\pg_sample_data\pg_sample_data_mes.sql
[0m10:38:32.139810 [debug] [MainThread]: Partial parsing: deleted file: demo_dbt://models\pg_sample_data\pg_samole_data_mes.sql
[0m10:38:32.151477 [debug] [MainThread]: 1699: static parser successfully parsed pg_sample_data\pg_sample_data_mes.sql
[0m10:38:32.214073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eefa341a-61c3-4396-be0b-0ca9ef9fbb82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C10F0ADE40>]}
[0m10:38:32.222091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eefa341a-61c3-4396-be0b-0ca9ef9fbb82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C10F11A620>]}
[0m10:38:32.222091 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m10:38:32.223072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eefa341a-61c3-4396-be0b-0ca9ef9fbb82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C10F11A530>]}
[0m10:38:32.224815 [info ] [MainThread]: 
[0m10:38:32.225817 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:38:32.228065 [debug] [ThreadPool]: Acquiring new postgres connection "list_stage"
[0m10:38:32.243887 [debug] [ThreadPool]: Using postgres connection "list_stage"
[0m10:38:32.244386 [debug] [ThreadPool]: On list_stage: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "list_stage"} */

    select distinct nspname from pg_namespace
  
[0m10:38:32.244735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:32.307785 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.06 seconds
[0m10:38:32.309733 [debug] [ThreadPool]: On list_stage: Close
[0m10:38:32.311767 [debug] [ThreadPool]: Acquiring new postgres connection "list_stage_mes"
[0m10:38:32.316736 [debug] [ThreadPool]: Using postgres connection "list_stage_mes"
[0m10:38:32.317488 [debug] [ThreadPool]: On list_stage_mes: BEGIN
[0m10:38:32.317942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:38:32.345098 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
[0m10:38:32.345620 [debug] [ThreadPool]: Using postgres connection "list_stage_mes"
[0m10:38:32.346072 [debug] [ThreadPool]: On list_stage_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "list_stage_mes"} */
select
      'stage' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mes'
    union all
    select
      'stage' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mes'
  
[0m10:38:32.359580 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.01 seconds
[0m10:38:32.361265 [debug] [ThreadPool]: On list_stage_mes: ROLLBACK
[0m10:38:32.362363 [debug] [ThreadPool]: On list_stage_mes: Close
[0m10:38:32.366622 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:32.367119 [debug] [MainThread]: On master: BEGIN
[0m10:38:32.367119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:38:32.390839 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m10:38:32.391358 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:32.391358 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:38:32.407299 [debug] [MainThread]: SQL status: SELECT 2 in 0.02 seconds
[0m10:38:32.408385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eefa341a-61c3-4396-be0b-0ca9ef9fbb82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C10F183D60>]}
[0m10:38:32.408915 [debug] [MainThread]: On master: ROLLBACK
[0m10:38:32.409965 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:32.409965 [debug] [MainThread]: On master: BEGIN
[0m10:38:32.411529 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:38:32.412049 [debug] [MainThread]: On master: COMMIT
[0m10:38:32.412049 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:32.412049 [debug] [MainThread]: On master: COMMIT
[0m10:38:32.413118 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:38:32.413640 [debug] [MainThread]: On master: Close
[0m10:38:32.414162 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:38:32.414692 [info ] [MainThread]: 
[0m10:38:32.420313 [debug] [Thread-1 (]: Began running node model.demo_dbt.my_first_dbt_model
[0m10:38:32.420814 [info ] [Thread-1 (]: 1 of 3 START sql table model mes.my_first_dbt_model ............................ [RUN]
[0m10:38:32.421812 [debug] [Thread-1 (]: Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model"
[0m10:38:32.421812 [debug] [Thread-1 (]: Began compiling node model.demo_dbt.my_first_dbt_model
[0m10:38:32.422313 [debug] [Thread-1 (]: Compiling model.demo_dbt.my_first_dbt_model
[0m10:38:32.424312 [debug] [Thread-1 (]: Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
[0m10:38:32.424813 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:32.425313 [debug] [Thread-1 (]: Began executing node model.demo_dbt.my_first_dbt_model
[0m10:38:32.457392 [debug] [Thread-1 (]: Writing runtime sql for node "model.demo_dbt.my_first_dbt_model"
[0m10:38:32.458373 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m10:38:32.458373 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: BEGIN
[0m10:38:32.458373 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:38:32.496709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m10:38:32.497233 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m10:38:32.497233 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */

  
    

  create  table "stage"."mes"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m10:38:32.505057 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.01 seconds
[0m10:38:32.510467 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m10:38:32.510467 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "stage"."mes"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m10:38:32.512450 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:38:32.514950 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m10:38:32.514950 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "stage"."mes"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m10:38:32.516950 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:38:32.534957 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: COMMIT
[0m10:38:32.534957 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m10:38:32.534957 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: COMMIT
[0m10:38:32.545783 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m10:38:32.550060 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m10:38:32.550573 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "stage"."mes"."my_first_dbt_model__dbt_backup" cascade
[0m10:38:32.557867 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.01 seconds
[0m10:38:32.558944 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:32.559500 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: Close
[0m10:38:32.560034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eefa341a-61c3-4396-be0b-0ca9ef9fbb82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C10EFF33A0>]}
[0m10:38:32.560572 [info ] [Thread-1 (]: 1 of 3 OK created sql table model mes.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.14s]
[0m10:38:32.561487 [debug] [Thread-1 (]: Finished running node model.demo_dbt.my_first_dbt_model
[0m10:38:32.561487 [debug] [Thread-1 (]: Began running node model.demo_dbt.pg_sample_data_mes
[0m10:38:32.561987 [info ] [Thread-1 (]: 2 of 3 START sql view model mes.pg_sample_data_mes ............................. [RUN]
[0m10:38:32.562986 [debug] [Thread-1 (]: Acquiring new postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m10:38:32.563582 [debug] [Thread-1 (]: Began compiling node model.demo_dbt.pg_sample_data_mes
[0m10:38:32.563582 [debug] [Thread-1 (]: Compiling model.demo_dbt.pg_sample_data_mes
[0m10:38:32.566087 [debug] [Thread-1 (]: Writing injected SQL for node "model.demo_dbt.pg_sample_data_mes"
[0m10:38:32.566991 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:32.566991 [debug] [Thread-1 (]: Began executing node model.demo_dbt.pg_sample_data_mes
[0m10:38:32.582523 [debug] [Thread-1 (]: Writing runtime sql for node "model.demo_dbt.pg_sample_data_mes"
[0m10:38:32.582523 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m10:38:32.583602 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: BEGIN
[0m10:38:32.584103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:32.623373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m10:38:32.623373 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m10:38:32.623894 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.pg_sample_data_mes"} */

  create view "stage"."mes"."pg_sample_data_mes__dbt_tmp" as (
    with dataserver_data as (
    select * from "stage"."mes"."dataserver_data"
),

final as (
select * from dataserver_data
)

select * from final
  );
[0m10:38:32.630672 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m10:38:32.633945 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m10:38:32.633945 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.pg_sample_data_mes"} */
alter table "stage"."mes"."pg_sample_data_mes__dbt_tmp" rename to "pg_sample_data_mes"
[0m10:38:32.635525 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:38:32.637064 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: COMMIT
[0m10:38:32.637565 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m10:38:32.637565 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: COMMIT
[0m10:38:32.640065 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:38:32.641583 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m10:38:32.642083 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.pg_sample_data_mes"} */
drop view if exists "stage"."mes"."pg_sample_data_mes__dbt_backup" cascade
[0m10:38:32.643065 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:38:32.644085 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:32.644564 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: Close
[0m10:38:32.645063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eefa341a-61c3-4396-be0b-0ca9ef9fbb82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C10F293CD0>]}
[0m10:38:32.646066 [info ] [Thread-1 (]: 2 of 3 OK created sql view model mes.pg_sample_data_mes ........................ [[32mCREATE VIEW[0m in 0.08s]
[0m10:38:32.646567 [debug] [Thread-1 (]: Finished running node model.demo_dbt.pg_sample_data_mes
[0m10:38:32.647067 [debug] [Thread-1 (]: Began running node model.demo_dbt.my_second_dbt_model
[0m10:38:32.647580 [info ] [Thread-1 (]: 3 of 3 START sql view model mes.my_second_dbt_model ............................ [RUN]
[0m10:38:32.648599 [debug] [Thread-1 (]: Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model"
[0m10:38:32.649064 [debug] [Thread-1 (]: Began compiling node model.demo_dbt.my_second_dbt_model
[0m10:38:32.649365 [debug] [Thread-1 (]: Compiling model.demo_dbt.my_second_dbt_model
[0m10:38:32.652067 [debug] [Thread-1 (]: Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
[0m10:38:32.653065 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:32.653065 [debug] [Thread-1 (]: Began executing node model.demo_dbt.my_second_dbt_model
[0m10:38:32.656564 [debug] [Thread-1 (]: Writing runtime sql for node "model.demo_dbt.my_second_dbt_model"
[0m10:38:32.657064 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m10:38:32.657564 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: BEGIN
[0m10:38:32.657564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:38:32.700314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m10:38:32.700814 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m10:38:32.700814 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "stage"."mes"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "stage"."mes"."my_first_dbt_model"
where id = 1
  );
[0m10:38:32.706814 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m10:38:32.709332 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m10:38:32.709332 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "stage"."mes"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m10:38:32.711313 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:38:32.712832 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: COMMIT
[0m10:38:32.712832 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m10:38:32.713314 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: COMMIT
[0m10:38:32.719316 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m10:38:32.721335 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m10:38:32.721335 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "stage"."mes"."my_second_dbt_model__dbt_backup" cascade
[0m10:38:32.723209 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:38:32.724223 [debug] [Thread-1 (]: finished collecting timing info
[0m10:38:32.724723 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: Close
[0m10:38:32.725207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eefa341a-61c3-4396-be0b-0ca9ef9fbb82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C10F1C3490>]}
[0m10:38:32.725709 [info ] [Thread-1 (]: 3 of 3 OK created sql view model mes.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.08s]
[0m10:38:32.726709 [debug] [Thread-1 (]: Finished running node model.demo_dbt.my_second_dbt_model
[0m10:38:32.728207 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m10:38:32.728706 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:32.729098 [debug] [MainThread]: On master: BEGIN
[0m10:38:32.729444 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:38:32.755895 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m10:38:32.756351 [debug] [MainThread]: On master: COMMIT
[0m10:38:32.756351 [debug] [MainThread]: Using postgres connection "master"
[0m10:38:32.756351 [debug] [MainThread]: On master: COMMIT
[0m10:38:32.757838 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:38:32.758338 [debug] [MainThread]: On master: Close
[0m10:38:32.758838 [info ] [MainThread]: 
[0m10:38:32.759337 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m10:38:32.759839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:38:32.760339 [debug] [MainThread]: Connection 'list_stage' was properly closed.
[0m10:38:32.760339 [debug] [MainThread]: Connection 'list_stage_mes' was properly closed.
[0m10:38:32.760838 [debug] [MainThread]: Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
[0m10:38:32.767091 [info ] [MainThread]: 
[0m10:38:32.767611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:38:32.768142 [info ] [MainThread]: 
[0m10:38:32.768669 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m10:38:32.769742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C10F28B100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C10F2CA560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C10F179C00>]}
[0m10:38:32.769742 [debug] [MainThread]: Flushing usage events


============================== 2022-10-26 12:37:24.288388 | 22f62680-f5d0-44a8-8331-5aed61bb41ae ==============================
[0m12:37:24.288388 [info ] [MainThread]: Running with dbt=1.3.0
[0m12:37:24.289386 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:37:24.291014 [debug] [MainThread]: Tracking: tracking
[0m12:37:24.332776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE9E2D3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE9E2DDB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE9E2D360>]}
[0m12:37:24.465657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:37:24.465657 [debug] [MainThread]: Partial parsing: updated file: demo_dbt://models\pg_sample_data\pg_sample_data_mes.sql
[0m12:37:24.478212 [debug] [MainThread]: 1699: static parser successfully parsed pg_sample_data\pg_sample_data_mes.sql
[0m12:37:24.530245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22f62680-f5d0-44a8-8331-5aed61bb41ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE9EEDED0>]}
[0m12:37:24.539485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22f62680-f5d0-44a8-8331-5aed61bb41ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE9F5A620>]}
[0m12:37:24.539485 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m12:37:24.540483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22f62680-f5d0-44a8-8331-5aed61bb41ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE9F5A530>]}
[0m12:37:24.541483 [info ] [MainThread]: 
[0m12:37:24.542482 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m12:37:24.544481 [debug] [ThreadPool]: Acquiring new postgres connection "list_stage"
[0m12:37:24.552483 [debug] [ThreadPool]: Using postgres connection "list_stage"
[0m12:37:24.553482 [debug] [ThreadPool]: On list_stage: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "list_stage"} */

    select distinct nspname from pg_namespace
  
[0m12:37:24.553482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:24.647713 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.09 seconds
[0m12:37:24.648783 [debug] [ThreadPool]: On list_stage: Close
[0m12:37:24.650351 [debug] [ThreadPool]: Acquiring new postgres connection "list_stage_mes"
[0m12:37:24.655600 [debug] [ThreadPool]: Using postgres connection "list_stage_mes"
[0m12:37:24.655600 [debug] [ThreadPool]: On list_stage_mes: BEGIN
[0m12:37:24.656101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:24.696101 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m12:37:24.696601 [debug] [ThreadPool]: Using postgres connection "list_stage_mes"
[0m12:37:24.696601 [debug] [ThreadPool]: On list_stage_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "list_stage_mes"} */
select
      'stage' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mes'
    union all
    select
      'stage' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mes'
  
[0m12:37:24.725974 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.03 seconds
[0m12:37:24.727639 [debug] [ThreadPool]: On list_stage_mes: ROLLBACK
[0m12:37:24.728718 [debug] [ThreadPool]: On list_stage_mes: Close
[0m12:37:24.732890 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:24.733414 [debug] [MainThread]: On master: BEGIN
[0m12:37:24.733414 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:24.785375 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m12:37:24.785642 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:24.786328 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:37:24.826260 [debug] [MainThread]: SQL status: SELECT 2 in 0.04 seconds
[0m12:37:24.827860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22f62680-f5d0-44a8-8331-5aed61bb41ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE9FCA380>]}
[0m12:37:24.827860 [debug] [MainThread]: On master: ROLLBACK
[0m12:37:24.829441 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:24.829967 [debug] [MainThread]: On master: BEGIN
[0m12:37:24.832059 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:37:24.832059 [debug] [MainThread]: On master: COMMIT
[0m12:37:24.832580 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:24.832580 [debug] [MainThread]: On master: COMMIT
[0m12:37:24.833624 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:37:24.834145 [debug] [MainThread]: On master: Close
[0m12:37:24.834668 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:37:24.835193 [info ] [MainThread]: 
[0m12:37:24.843143 [debug] [Thread-1 (]: Began running node model.demo_dbt.my_first_dbt_model
[0m12:37:24.843670 [info ] [Thread-1 (]: 1 of 3 START sql table model mes.my_first_dbt_model ............................ [RUN]
[0m12:37:24.844736 [debug] [Thread-1 (]: Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model"
[0m12:37:24.844736 [debug] [Thread-1 (]: Began compiling node model.demo_dbt.my_first_dbt_model
[0m12:37:24.845248 [debug] [Thread-1 (]: Compiling model.demo_dbt.my_first_dbt_model
[0m12:37:24.847264 [debug] [Thread-1 (]: Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
[0m12:37:24.848356 [debug] [Thread-1 (]: finished collecting timing info
[0m12:37:24.848356 [debug] [Thread-1 (]: Began executing node model.demo_dbt.my_first_dbt_model
[0m12:37:24.883022 [debug] [Thread-1 (]: Writing runtime sql for node "model.demo_dbt.my_first_dbt_model"
[0m12:37:24.884022 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m12:37:24.885021 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: BEGIN
[0m12:37:24.885021 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:37:24.945719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.06 seconds
[0m12:37:24.946243 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m12:37:24.946768 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */

  
    

  create  table "stage"."mes"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m12:37:24.973412 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.03 seconds
[0m12:37:24.979276 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m12:37:24.979777 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "stage"."mes"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:37:24.983760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:37:24.986257 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m12:37:24.986257 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "stage"."mes"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:37:24.988758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:37:25.006794 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: COMMIT
[0m12:37:25.007780 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m12:37:25.008271 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: COMMIT
[0m12:37:25.022120 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m12:37:25.027023 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m12:37:25.027546 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "stage"."mes"."my_first_dbt_model__dbt_backup" cascade
[0m12:37:25.050398 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.02 seconds
[0m12:37:25.051458 [debug] [Thread-1 (]: finished collecting timing info
[0m12:37:25.051962 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: Close
[0m12:37:25.052509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22f62680-f5d0-44a8-8331-5aed61bb41ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE9E2CC40>]}
[0m12:37:25.053040 [info ] [Thread-1 (]: 1 of 3 OK created sql table model mes.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.21s]
[0m12:37:25.053562 [debug] [Thread-1 (]: Finished running node model.demo_dbt.my_first_dbt_model
[0m12:37:25.054364 [debug] [Thread-1 (]: Began running node model.demo_dbt.pg_sample_data_mes
[0m12:37:25.054838 [info ] [Thread-1 (]: 2 of 3 START sql view model mes.pg_sample_data_mes ............................. [RUN]
[0m12:37:25.055891 [debug] [Thread-1 (]: Acquiring new postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m12:37:25.056337 [debug] [Thread-1 (]: Began compiling node model.demo_dbt.pg_sample_data_mes
[0m12:37:25.056337 [debug] [Thread-1 (]: Compiling model.demo_dbt.pg_sample_data_mes
[0m12:37:25.059338 [debug] [Thread-1 (]: Writing injected SQL for node "model.demo_dbt.pg_sample_data_mes"
[0m12:37:25.060338 [debug] [Thread-1 (]: finished collecting timing info
[0m12:37:25.060338 [debug] [Thread-1 (]: Began executing node model.demo_dbt.pg_sample_data_mes
[0m12:37:25.075663 [debug] [Thread-1 (]: Writing runtime sql for node "model.demo_dbt.pg_sample_data_mes"
[0m12:37:25.077667 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m12:37:25.077667 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: BEGIN
[0m12:37:25.077667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:25.129146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m12:37:25.129927 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m12:37:25.129927 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.pg_sample_data_mes"} */

  create view "stage"."mes"."pg_sample_data_mes__dbt_tmp" as (
    with dataserver_data as (
    select * from "stage"."mes"."dataserver_data"
    where dic_dataservers_id = 2
),

final as (
select * from dataserver_data
)

select * from final
  );
[0m12:37:25.141367 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m12:37:25.144880 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m12:37:25.145380 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.pg_sample_data_mes"} */
alter table "stage"."mes"."pg_sample_data_mes" rename to "pg_sample_data_mes__dbt_backup"
[0m12:37:25.147364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:37:25.149363 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m12:37:25.149865 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.pg_sample_data_mes"} */
alter table "stage"."mes"."pg_sample_data_mes__dbt_tmp" rename to "pg_sample_data_mes"
[0m12:37:25.151382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:37:25.152883 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: COMMIT
[0m12:37:25.153387 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m12:37:25.153387 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: COMMIT
[0m12:37:25.162865 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m12:37:25.164881 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m12:37:25.165381 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.pg_sample_data_mes"} */
drop view if exists "stage"."mes"."pg_sample_data_mes__dbt_backup" cascade
[0m12:37:25.168829 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:37:25.169918 [debug] [Thread-1 (]: finished collecting timing info
[0m12:37:25.170436 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: Close
[0m12:37:25.170957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22f62680-f5d0-44a8-8331-5aed61bb41ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE9FC7E80>]}
[0m12:37:25.171471 [info ] [Thread-1 (]: 2 of 3 OK created sql view model mes.pg_sample_data_mes ........................ [[32mCREATE VIEW[0m in 0.12s]
[0m12:37:25.172005 [debug] [Thread-1 (]: Finished running node model.demo_dbt.pg_sample_data_mes
[0m12:37:25.172535 [debug] [Thread-1 (]: Began running node model.demo_dbt.my_second_dbt_model
[0m12:37:25.173064 [info ] [Thread-1 (]: 3 of 3 START sql view model mes.my_second_dbt_model ............................ [RUN]
[0m12:37:25.174301 [debug] [Thread-1 (]: Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model"
[0m12:37:25.174872 [debug] [Thread-1 (]: Began compiling node model.demo_dbt.my_second_dbt_model
[0m12:37:25.175045 [debug] [Thread-1 (]: Compiling model.demo_dbt.my_second_dbt_model
[0m12:37:25.177878 [debug] [Thread-1 (]: Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
[0m12:37:25.179284 [debug] [Thread-1 (]: finished collecting timing info
[0m12:37:25.179602 [debug] [Thread-1 (]: Began executing node model.demo_dbt.my_second_dbt_model
[0m12:37:25.182601 [debug] [Thread-1 (]: Writing runtime sql for node "model.demo_dbt.my_second_dbt_model"
[0m12:37:25.183582 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m12:37:25.184083 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: BEGIN
[0m12:37:25.184083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:25.220450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m12:37:25.220974 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m12:37:25.220974 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "stage"."mes"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "stage"."mes"."my_first_dbt_model"
where id = 1
  );
[0m12:37:25.228353 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m12:37:25.230869 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m12:37:25.231352 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "stage"."mes"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:37:25.232853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:37:25.234351 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: COMMIT
[0m12:37:25.234851 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m12:37:25.234851 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: COMMIT
[0m12:37:25.238351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:37:25.240351 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m12:37:25.240853 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "stage"."mes"."my_second_dbt_model__dbt_backup" cascade
[0m12:37:25.242852 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:37:25.244352 [debug] [Thread-1 (]: finished collecting timing info
[0m12:37:25.244850 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: Close
[0m12:37:25.245352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22f62680-f5d0-44a8-8331-5aed61bb41ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE9FC5330>]}
[0m12:37:25.245853 [info ] [Thread-1 (]: 3 of 3 OK created sql view model mes.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.07s]
[0m12:37:25.246853 [debug] [Thread-1 (]: Finished running node model.demo_dbt.my_second_dbt_model
[0m12:37:25.248609 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m12:37:25.249107 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:25.249352 [debug] [MainThread]: On master: BEGIN
[0m12:37:25.249352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:37:25.280898 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m12:37:25.281416 [debug] [MainThread]: On master: COMMIT
[0m12:37:25.281416 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:25.281943 [debug] [MainThread]: On master: COMMIT
[0m12:37:25.282996 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:37:25.283519 [debug] [MainThread]: On master: Close
[0m12:37:25.284049 [info ] [MainThread]: 
[0m12:37:25.285051 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m12:37:25.285686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:25.285839 [debug] [MainThread]: Connection 'list_stage' was properly closed.
[0m12:37:25.286289 [debug] [MainThread]: Connection 'list_stage_mes' was properly closed.
[0m12:37:25.286510 [debug] [MainThread]: Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
[0m12:37:25.295183 [info ] [MainThread]: 
[0m12:37:25.295685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:25.296683 [info ] [MainThread]: 
[0m12:37:25.297182 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:37:25.297684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE9F8E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFEA106650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFE9FBA4D0>]}
[0m12:37:25.297684 [debug] [MainThread]: Flushing usage events


============================== 2022-10-26 13:41:03.909149 | 501bdea4-c52a-4a7a-8899-1f649280e3e9 ==============================
[0m13:41:03.909149 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:41:03.911687 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
[0m13:41:03.912598 [debug] [MainThread]: Tracking: tracking
[0m13:41:03.947861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D8C8F13F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D8C8F1DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D8C8F1360>]}
[0m13:41:04.726318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:41:04.726318 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:41:04.733497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '501bdea4-c52a-4a7a-8899-1f649280e3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D8CA840D0>]}
[0m13:41:04.740480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '501bdea4-c52a-4a7a-8899-1f649280e3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D8C9B9360>]}
[0m13:41:04.741483 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:41:04.742480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '501bdea4-c52a-4a7a-8899-1f649280e3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D8C9B9720>]}
[0m13:41:04.743498 [info ] [MainThread]: 
[0m13:41:04.744480 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m13:41:04.746485 [debug] [ThreadPool]: Acquiring new postgres connection "list_stage_mes"
[0m13:41:04.754870 [debug] [ThreadPool]: Using postgres connection "list_stage_mes"
[0m13:41:04.754870 [debug] [ThreadPool]: On list_stage_mes: BEGIN
[0m13:41:04.755895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:04.864429 [debug] [ThreadPool]: SQL status: BEGIN in 0.11 seconds
[0m13:41:04.864429 [debug] [ThreadPool]: Using postgres connection "list_stage_mes"
[0m13:41:04.864928 [debug] [ThreadPool]: On list_stage_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "list_stage_mes"} */
select
      'stage' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mes'
    union all
    select
      'stage' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mes'
  
[0m13:41:04.988457 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.12 seconds
[0m13:41:04.990134 [debug] [ThreadPool]: On list_stage_mes: ROLLBACK
[0m13:41:04.992771 [debug] [ThreadPool]: On list_stage_mes: Close
[0m13:41:04.997619 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:04.997619 [debug] [MainThread]: On master: BEGIN
[0m13:41:04.998141 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:05.028047 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m13:41:05.028546 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:05.028546 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:41:05.098835 [debug] [MainThread]: SQL status: SELECT 2 in 0.07 seconds
[0m13:41:05.099882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '501bdea4-c52a-4a7a-8899-1f649280e3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D8CA1ADD0>]}
[0m13:41:05.100440 [debug] [MainThread]: On master: ROLLBACK
[0m13:41:05.101476 [debug] [MainThread]: On master: Close
[0m13:41:05.101998 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:41:05.103234 [info ] [MainThread]: 
[0m13:41:05.140254 [debug] [Thread-1 (]: Began running node model.demo_dbt.my_first_dbt_model
[0m13:41:05.141254 [debug] [Thread-1 (]: Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model"
[0m13:41:05.141254 [debug] [Thread-1 (]: Began compiling node model.demo_dbt.my_first_dbt_model
[0m13:41:05.141254 [debug] [Thread-1 (]: Compiling model.demo_dbt.my_first_dbt_model
[0m13:41:05.144474 [debug] [Thread-1 (]: Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
[0m13:41:05.144474 [debug] [Thread-1 (]: finished collecting timing info
[0m13:41:05.145490 [debug] [Thread-1 (]: Began executing node model.demo_dbt.my_first_dbt_model
[0m13:41:05.145490 [debug] [Thread-1 (]: finished collecting timing info
[0m13:41:05.145490 [debug] [Thread-1 (]: Finished running node model.demo_dbt.my_first_dbt_model
[0m13:41:05.146512 [debug] [Thread-1 (]: Began running node model.demo_dbt.pg_sample_data_mes
[0m13:41:05.146512 [debug] [Thread-1 (]: Acquiring new postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m13:41:05.147511 [debug] [Thread-1 (]: Began compiling node model.demo_dbt.pg_sample_data_mes
[0m13:41:05.147511 [debug] [Thread-1 (]: Compiling model.demo_dbt.pg_sample_data_mes
[0m13:41:05.150506 [debug] [Thread-1 (]: Writing injected SQL for node "model.demo_dbt.pg_sample_data_mes"
[0m13:41:05.151490 [debug] [Thread-1 (]: finished collecting timing info
[0m13:41:05.151490 [debug] [Thread-1 (]: Began executing node model.demo_dbt.pg_sample_data_mes
[0m13:41:05.151490 [debug] [Thread-1 (]: finished collecting timing info
[0m13:41:05.152490 [debug] [Thread-1 (]: Finished running node model.demo_dbt.pg_sample_data_mes
[0m13:41:05.152490 [debug] [Thread-1 (]: Began running node model.demo_dbt.my_second_dbt_model
[0m13:41:05.153493 [debug] [Thread-1 (]: Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model"
[0m13:41:05.153493 [debug] [Thread-1 (]: Began compiling node model.demo_dbt.my_second_dbt_model
[0m13:41:05.153493 [debug] [Thread-1 (]: Compiling model.demo_dbt.my_second_dbt_model
[0m13:41:05.155493 [debug] [Thread-1 (]: Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
[0m13:41:05.156494 [debug] [Thread-1 (]: finished collecting timing info
[0m13:41:05.156494 [debug] [Thread-1 (]: Began executing node model.demo_dbt.my_second_dbt_model
[0m13:41:05.156494 [debug] [Thread-1 (]: finished collecting timing info
[0m13:41:05.157493 [debug] [Thread-1 (]: Finished running node model.demo_dbt.my_second_dbt_model
[0m13:41:05.157493 [debug] [Thread-1 (]: Began running node test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:41:05.158310 [debug] [Thread-1 (]: Acquiring new postgres connection "test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:41:05.158310 [debug] [Thread-1 (]: Began compiling node test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:41:05.158310 [debug] [Thread-1 (]: Compiling test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:41:05.169749 [debug] [Thread-1 (]: Writing injected SQL for node "test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:41:05.170877 [debug] [Thread-1 (]: finished collecting timing info
[0m13:41:05.170877 [debug] [Thread-1 (]: Began executing node test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:41:05.170877 [debug] [Thread-1 (]: finished collecting timing info
[0m13:41:05.171935 [debug] [Thread-1 (]: Finished running node test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:41:05.171935 [debug] [Thread-1 (]: Began running node test.demo_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:41:05.172930 [debug] [Thread-1 (]: Acquiring new postgres connection "test.demo_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m13:41:05.173175 [debug] [Thread-1 (]: Began compiling node test.demo_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:41:05.173175 [debug] [Thread-1 (]: Compiling test.demo_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:41:05.178192 [debug] [Thread-1 (]: Writing injected SQL for node "test.demo_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m13:41:05.179192 [debug] [Thread-1 (]: finished collecting timing info
[0m13:41:05.179192 [debug] [Thread-1 (]: Began executing node test.demo_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:41:05.179192 [debug] [Thread-1 (]: finished collecting timing info
[0m13:41:05.180193 [debug] [Thread-1 (]: Finished running node test.demo_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:41:05.180193 [debug] [Thread-1 (]: Began running node test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:41:05.180193 [debug] [Thread-1 (]: Acquiring new postgres connection "test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m13:41:05.181270 [debug] [Thread-1 (]: Began compiling node test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:41:05.181270 [debug] [Thread-1 (]: Compiling test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:41:05.184293 [debug] [Thread-1 (]: Writing injected SQL for node "test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m13:41:05.185789 [debug] [Thread-1 (]: finished collecting timing info
[0m13:41:05.185789 [debug] [Thread-1 (]: Began executing node test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:41:05.185789 [debug] [Thread-1 (]: finished collecting timing info
[0m13:41:05.186797 [debug] [Thread-1 (]: Finished running node test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:41:05.186797 [debug] [Thread-1 (]: Began running node test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:41:05.186797 [debug] [Thread-1 (]: Acquiring new postgres connection "test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:41:05.187871 [debug] [Thread-1 (]: Began compiling node test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:41:05.187871 [debug] [Thread-1 (]: Compiling test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:41:05.190879 [debug] [Thread-1 (]: Writing injected SQL for node "test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:41:05.191798 [debug] [Thread-1 (]: finished collecting timing info
[0m13:41:05.191798 [debug] [Thread-1 (]: Began executing node test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:41:05.191798 [debug] [Thread-1 (]: finished collecting timing info
[0m13:41:05.192796 [debug] [Thread-1 (]: Finished running node test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:41:05.193640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:05.193640 [debug] [MainThread]: Connection 'list_stage_mes' was properly closed.
[0m13:41:05.194649 [debug] [MainThread]: Connection 'test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:41:05.200913 [info ] [MainThread]: Done.
[0m13:41:05.201928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D8CB37D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D8CB379A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D8CB36350>]}
[0m13:41:05.201928 [debug] [MainThread]: Flushing usage events


============================== 2022-10-27 04:15:15.112536 | 49328324-8c0b-4b33-a909-93ab66db5777 ==============================
[0m04:15:15.112536 [info ] [MainThread]: Running with dbt=1.3.0
[0m04:15:15.114531 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m04:15:15.114531 [debug] [MainThread]: Tracking: tracking
[0m04:15:15.159623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FDB96D3F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FDB96DDB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FDB96D360>]}
[0m04:15:15.987178 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:15:15.987178 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:15:15.996265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49328324-8c0b-4b33-a909-93ab66db5777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FDBB040D0>]}
[0m04:15:16.008483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49328324-8c0b-4b33-a909-93ab66db5777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FDBA391B0>]}
[0m04:15:16.009028 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m04:15:16.009482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49328324-8c0b-4b33-a909-93ab66db5777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FDBA39750>]}
[0m04:15:16.010326 [info ] [MainThread]: 
[0m04:15:16.011699 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:15:16.014797 [debug] [ThreadPool]: Acquiring new postgres connection "list_stage_mes"
[0m04:15:16.030293 [debug] [ThreadPool]: Using postgres connection "list_stage_mes"
[0m04:15:16.031293 [debug] [ThreadPool]: On list_stage_mes: BEGIN
[0m04:15:16.031867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:15:16.209891 [debug] [ThreadPool]: SQL status: BEGIN in 0.18 seconds
[0m04:15:16.210516 [debug] [ThreadPool]: Using postgres connection "list_stage_mes"
[0m04:15:16.210791 [debug] [ThreadPool]: On list_stage_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "list_stage_mes"} */
select
      'stage' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mes'
    union all
    select
      'stage' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mes'
  
[0m04:15:16.378530 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.17 seconds
[0m04:15:16.379578 [debug] [ThreadPool]: On list_stage_mes: ROLLBACK
[0m04:15:16.382705 [debug] [ThreadPool]: On list_stage_mes: Close
[0m04:15:16.392601 [debug] [MainThread]: Using postgres connection "master"
[0m04:15:16.393145 [debug] [MainThread]: On master: BEGIN
[0m04:15:16.393598 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:15:16.439855 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
[0m04:15:16.440274 [debug] [MainThread]: Using postgres connection "master"
[0m04:15:16.440774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:15:16.541909 [debug] [MainThread]: SQL status: SELECT 2 in 0.1 seconds
[0m04:15:16.544012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49328324-8c0b-4b33-a909-93ab66db5777', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FDBA39330>]}
[0m04:15:16.544537 [debug] [MainThread]: On master: ROLLBACK
[0m04:15:16.546006 [debug] [MainThread]: Using postgres connection "master"
[0m04:15:16.546006 [debug] [MainThread]: On master: BEGIN
[0m04:15:16.548505 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:15:16.549005 [debug] [MainThread]: On master: COMMIT
[0m04:15:16.549505 [debug] [MainThread]: Using postgres connection "master"
[0m04:15:16.550006 [debug] [MainThread]: On master: COMMIT
[0m04:15:16.555047 [debug] [MainThread]: SQL status: COMMIT in 0.01 seconds
[0m04:15:16.556046 [debug] [MainThread]: On master: Close
[0m04:15:16.556547 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:15:16.557476 [info ] [MainThread]: 
[0m04:15:16.603219 [debug] [Thread-1 (]: Began running node test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m04:15:16.604232 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m04:15:16.606449 [debug] [Thread-1 (]: Acquiring new postgres connection "test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m04:15:16.607229 [debug] [Thread-1 (]: Began compiling node test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m04:15:16.607483 [debug] [Thread-1 (]: Compiling test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m04:15:16.623760 [debug] [Thread-1 (]: Writing injected SQL for node "test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m04:15:16.627887 [debug] [Thread-1 (]: finished collecting timing info
[0m04:15:16.628388 [debug] [Thread-1 (]: Began executing node test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m04:15:16.656756 [debug] [Thread-1 (]: Writing runtime sql for node "test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m04:15:16.659271 [debug] [Thread-1 (]: Using postgres connection "test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m04:15:16.659271 [debug] [Thread-1 (]: On test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m04:15:16.659773 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:15:16.706129 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m04:15:16.706794 [debug] [Thread-1 (]: Using postgres connection "test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m04:15:16.707025 [debug] [Thread-1 (]: On test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "stage"."mes"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m04:15:16.748044 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.04 seconds
[0m04:15:16.752679 [debug] [Thread-1 (]: finished collecting timing info
[0m04:15:16.753673 [debug] [Thread-1 (]: On test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m04:15:16.755657 [debug] [Thread-1 (]: On test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m04:15:16.756680 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.15s]
[0m04:15:16.758155 [debug] [Thread-1 (]: Finished running node test.demo_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m04:15:16.758674 [debug] [Thread-1 (]: Began running node test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m04:15:16.759158 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m04:15:16.760158 [debug] [Thread-1 (]: Acquiring new postgres connection "test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m04:15:16.760158 [debug] [Thread-1 (]: Began compiling node test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m04:15:16.760660 [debug] [Thread-1 (]: Compiling test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m04:15:16.764190 [debug] [Thread-1 (]: Writing injected SQL for node "test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m04:15:16.765279 [debug] [Thread-1 (]: finished collecting timing info
[0m04:15:16.765674 [debug] [Thread-1 (]: Began executing node test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m04:15:16.769146 [debug] [Thread-1 (]: Writing runtime sql for node "test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m04:15:16.771511 [debug] [Thread-1 (]: Using postgres connection "test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m04:15:16.771849 [debug] [Thread-1 (]: On test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m04:15:16.772105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:15:16.804905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:15:16.805538 [debug] [Thread-1 (]: Using postgres connection "test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m04:15:16.805538 [debug] [Thread-1 (]: On test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "stage"."mes"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m04:15:16.809544 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m04:15:16.811136 [debug] [Thread-1 (]: finished collecting timing info
[0m04:15:16.811808 [debug] [Thread-1 (]: On test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m04:15:16.812711 [debug] [Thread-1 (]: On test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m04:15:16.813710 [info ] [Thread-1 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.05s]
[0m04:15:16.814712 [debug] [Thread-1 (]: Finished running node test.demo_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m04:15:16.815237 [debug] [Thread-1 (]: Began running node test.demo_dbt.unique_my_first_dbt_model_id.16e066b321
[0m04:15:16.815728 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m04:15:16.817061 [debug] [Thread-1 (]: Acquiring new postgres connection "test.demo_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m04:15:16.818406 [debug] [Thread-1 (]: Began compiling node test.demo_dbt.unique_my_first_dbt_model_id.16e066b321
[0m04:15:16.818794 [debug] [Thread-1 (]: Compiling test.demo_dbt.unique_my_first_dbt_model_id.16e066b321
[0m04:15:16.826034 [debug] [Thread-1 (]: Writing injected SQL for node "test.demo_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m04:15:16.827702 [debug] [Thread-1 (]: finished collecting timing info
[0m04:15:16.827702 [debug] [Thread-1 (]: Began executing node test.demo_dbt.unique_my_first_dbt_model_id.16e066b321
[0m04:15:16.829106 [debug] [Thread-1 (]: Writing runtime sql for node "test.demo_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m04:15:16.830964 [debug] [Thread-1 (]: Using postgres connection "test.demo_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m04:15:16.831159 [debug] [Thread-1 (]: On test.demo_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m04:15:16.831159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:15:16.865510 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:15:16.865968 [debug] [Thread-1 (]: Using postgres connection "test.demo_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m04:15:16.866542 [debug] [Thread-1 (]: On test.demo_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "test.demo_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "stage"."mes"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:15:16.873441 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.01 seconds
[0m04:15:16.874943 [debug] [Thread-1 (]: finished collecting timing info
[0m04:15:16.875743 [debug] [Thread-1 (]: On test.demo_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m04:15:16.876941 [debug] [Thread-1 (]: On test.demo_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m04:15:16.877455 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
[0m04:15:16.878440 [debug] [Thread-1 (]: Finished running node test.demo_dbt.unique_my_first_dbt_model_id.16e066b321
[0m04:15:16.878940 [debug] [Thread-1 (]: Began running node test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m04:15:16.879439 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m04:15:16.880440 [debug] [Thread-1 (]: Acquiring new postgres connection "test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m04:15:16.880440 [debug] [Thread-1 (]: Began compiling node test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m04:15:16.881032 [debug] [Thread-1 (]: Compiling test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m04:15:16.888480 [debug] [Thread-1 (]: Writing injected SQL for node "test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m04:15:16.889702 [debug] [Thread-1 (]: finished collecting timing info
[0m04:15:16.889933 [debug] [Thread-1 (]: Began executing node test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m04:15:16.890987 [debug] [Thread-1 (]: Writing runtime sql for node "test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m04:15:16.893257 [debug] [Thread-1 (]: Using postgres connection "test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m04:15:16.893257 [debug] [Thread-1 (]: On test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m04:15:16.893714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:15:16.928597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.03 seconds
[0m04:15:16.928960 [debug] [Thread-1 (]: Using postgres connection "test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m04:15:16.928960 [debug] [Thread-1 (]: On test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "stage"."mes"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m04:15:16.931960 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m04:15:16.933460 [debug] [Thread-1 (]: finished collecting timing info
[0m04:15:16.934462 [debug] [Thread-1 (]: On test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m04:15:16.938960 [debug] [Thread-1 (]: On test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m04:15:16.939570 [info ] [Thread-1 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
[0m04:15:16.940460 [debug] [Thread-1 (]: Finished running node test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m04:15:16.942942 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:15:16.943456 [debug] [MainThread]: Using postgres connection "master"
[0m04:15:16.943779 [debug] [MainThread]: On master: BEGIN
[0m04:15:16.943971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:15:16.978925 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:15:16.979347 [debug] [MainThread]: On master: COMMIT
[0m04:15:16.979552 [debug] [MainThread]: Using postgres connection "master"
[0m04:15:16.979912 [debug] [MainThread]: On master: COMMIT
[0m04:15:16.981345 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:15:16.981846 [debug] [MainThread]: On master: Close
[0m04:15:16.982845 [info ] [MainThread]: 
[0m04:15:16.984114 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m04:15:16.985849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:15:16.987437 [debug] [MainThread]: Connection 'list_stage_mes' was properly closed.
[0m04:15:16.987850 [debug] [MainThread]: Connection 'test.demo_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m04:15:16.994760 [info ] [MainThread]: 
[0m04:15:16.995345 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:15:16.996346 [info ] [MainThread]: 
[0m04:15:16.996847 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m04:15:16.997591 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m04:15:16.998061 [info ] [MainThread]: 
[0m04:15:16.998061 [info ] [MainThread]:   compiled Code at target\compiled\demo_dbt\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m04:15:16.999398 [info ] [MainThread]: 
[0m04:15:17.000024 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m04:15:17.001138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FD9726FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FD9587A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025FDBBAA0E0>]}
[0m04:15:17.002510 [debug] [MainThread]: Flushing usage events


============================== 2022-10-27 04:28:32.852952 | 3f41005f-6566-4677-a593-83f07586d61f ==============================
[0m04:28:32.852952 [info ] [MainThread]: Running with dbt=1.3.0
[0m04:28:32.855954 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\User\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m04:28:32.855954 [debug] [MainThread]: Tracking: tracking
[0m04:28:32.894515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDD791390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDD791D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDD791300>]}
[0m04:28:32.923995 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m04:28:32.925007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3f41005f-6566-4677-a593-83f07586d61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDD78BE20>]}
[0m04:28:32.997575 [debug] [MainThread]: Parsing macros\adapters.sql
[0m04:28:33.016602 [debug] [MainThread]: Parsing macros\catalog.sql
[0m04:28:33.018603 [debug] [MainThread]: Parsing macros\relations.sql
[0m04:28:33.019604 [debug] [MainThread]: Parsing macros\timestamps.sql
[0m04:28:33.021603 [debug] [MainThread]: Parsing macros\materializations\incremental_strategies.sql
[0m04:28:33.022603 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
[0m04:28:33.023603 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m04:28:33.023603 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m04:28:33.024603 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m04:28:33.029609 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m04:28:33.030603 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m04:28:33.031603 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m04:28:33.032603 [debug] [MainThread]: Parsing macros\adapters\apply_grants.sql
[0m04:28:33.041602 [debug] [MainThread]: Parsing macros\adapters\columns.sql
[0m04:28:33.048977 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
[0m04:28:33.050964 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
[0m04:28:33.052970 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
[0m04:28:33.057974 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
[0m04:28:33.060992 [debug] [MainThread]: Parsing macros\adapters\relation.sql
[0m04:28:33.070976 [debug] [MainThread]: Parsing macros\adapters\schema.sql
[0m04:28:33.072966 [debug] [MainThread]: Parsing macros\adapters\timestamps.sql
[0m04:28:33.074962 [debug] [MainThread]: Parsing macros\etc\datetime.sql
[0m04:28:33.084226 [debug] [MainThread]: Parsing macros\etc\statement.sql
[0m04:28:33.090607 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
[0m04:28:33.093644 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
[0m04:28:33.094645 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
[0m04:28:33.095645 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
[0m04:28:33.096644 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
[0m04:28:33.098645 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
[0m04:28:33.102055 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
[0m04:28:33.106900 [debug] [MainThread]: Parsing macros\materializations\configs.sql
[0m04:28:33.115157 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
[0m04:28:33.121887 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
[0m04:28:33.129583 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
[0m04:28:33.168354 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
[0m04:28:33.170355 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
[0m04:28:33.186828 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
[0m04:28:33.198504 [debug] [MainThread]: Parsing macros\materializations\models\incremental\strategies.sql
[0m04:28:33.204283 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
[0m04:28:33.207298 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
[0m04:28:33.211370 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
[0m04:28:33.214372 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
[0m04:28:33.216372 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
[0m04:28:33.217072 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
[0m04:28:33.221910 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
[0m04:28:33.235714 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
[0m04:28:33.240724 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
[0m04:28:33.250442 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
[0m04:28:33.258526 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
[0m04:28:33.259443 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
[0m04:28:33.274028 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
[0m04:28:33.275454 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
[0m04:28:33.279581 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
[0m04:28:33.280804 [debug] [MainThread]: Parsing macros\python_model\python.sql
[0m04:28:33.286253 [debug] [MainThread]: Parsing macros\utils\any_value.sql
[0m04:28:33.286878 [debug] [MainThread]: Parsing macros\utils\array_append.sql
[0m04:28:33.288137 [debug] [MainThread]: Parsing macros\utils\array_concat.sql
[0m04:28:33.289078 [debug] [MainThread]: Parsing macros\utils\array_construct.sql
[0m04:28:33.290688 [debug] [MainThread]: Parsing macros\utils\bool_or.sql
[0m04:28:33.291528 [debug] [MainThread]: Parsing macros\utils\cast_bool_to_text.sql
[0m04:28:33.292139 [debug] [MainThread]: Parsing macros\utils\concat.sql
[0m04:28:33.292500 [debug] [MainThread]: Parsing macros\utils\data_types.sql
[0m04:28:33.298689 [debug] [MainThread]: Parsing macros\utils\dateadd.sql
[0m04:28:33.299540 [debug] [MainThread]: Parsing macros\utils\datediff.sql
[0m04:28:33.300273 [debug] [MainThread]: Parsing macros\utils\date_trunc.sql
[0m04:28:33.302013 [debug] [MainThread]: Parsing macros\utils\escape_single_quotes.sql
[0m04:28:33.302693 [debug] [MainThread]: Parsing macros\utils\except.sql
[0m04:28:33.303685 [debug] [MainThread]: Parsing macros\utils\hash.sql
[0m04:28:33.304688 [debug] [MainThread]: Parsing macros\utils\intersect.sql
[0m04:28:33.305406 [debug] [MainThread]: Parsing macros\utils\last_day.sql
[0m04:28:33.307027 [debug] [MainThread]: Parsing macros\utils\length.sql
[0m04:28:33.307765 [debug] [MainThread]: Parsing macros\utils\listagg.sql
[0m04:28:33.309855 [debug] [MainThread]: Parsing macros\utils\literal.sql
[0m04:28:33.310922 [debug] [MainThread]: Parsing macros\utils\position.sql
[0m04:28:33.311720 [debug] [MainThread]: Parsing macros\utils\replace.sql
[0m04:28:33.313773 [debug] [MainThread]: Parsing macros\utils\right.sql
[0m04:28:33.314787 [debug] [MainThread]: Parsing macros\utils\safe_cast.sql
[0m04:28:33.315744 [debug] [MainThread]: Parsing macros\utils\split_part.sql
[0m04:28:33.317415 [debug] [MainThread]: Parsing tests\generic\builtin.sql
[0m04:28:33.551512 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m04:28:33.562725 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m04:28:33.565727 [debug] [MainThread]: 1699: static parser successfully parsed pg_sample_data\pg_sample_data_mes.sql
[0m04:28:33.637239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f41005f-6566-4677-a593-83f07586d61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDD88B9D0>]}
[0m04:28:33.645389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f41005f-6566-4677-a593-83f07586d61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDD88B2B0>]}
[0m04:28:33.645389 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 289 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m04:28:33.646390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f41005f-6566-4677-a593-83f07586d61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDD91F7C0>]}
[0m04:28:33.647390 [info ] [MainThread]: 
[0m04:28:33.648392 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:28:33.650070 [debug] [ThreadPool]: Acquiring new postgres connection "list_stage"
[0m04:28:33.659294 [debug] [ThreadPool]: Using postgres connection "list_stage"
[0m04:28:33.660303 [debug] [ThreadPool]: On list_stage: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "list_stage"} */

    select distinct nspname from pg_namespace
  
[0m04:28:33.660303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:28:33.767369 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.11 seconds
[0m04:28:33.768432 [debug] [ThreadPool]: On list_stage: Close
[0m04:28:33.770037 [debug] [ThreadPool]: Acquiring new postgres connection "list_stage_mes"
[0m04:28:33.775862 [debug] [ThreadPool]: Using postgres connection "list_stage_mes"
[0m04:28:33.775862 [debug] [ThreadPool]: On list_stage_mes: BEGIN
[0m04:28:33.776361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:28:33.814677 [debug] [ThreadPool]: SQL status: BEGIN in 0.04 seconds
[0m04:28:33.815194 [debug] [ThreadPool]: Using postgres connection "list_stage_mes"
[0m04:28:33.815717 [debug] [ThreadPool]: On list_stage_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "list_stage_mes"} */
select
      'stage' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'mes'
    union all
    select
      'stage' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'mes'
  
[0m04:28:33.834636 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.02 seconds
[0m04:28:33.836217 [debug] [ThreadPool]: On list_stage_mes: ROLLBACK
[0m04:28:33.838859 [debug] [ThreadPool]: On list_stage_mes: Close
[0m04:28:33.842861 [debug] [MainThread]: Using postgres connection "master"
[0m04:28:33.843361 [debug] [MainThread]: On master: BEGIN
[0m04:28:33.843861 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:28:33.885705 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
[0m04:28:33.886206 [debug] [MainThread]: Using postgres connection "master"
[0m04:28:33.886709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:28:33.902880 [debug] [MainThread]: SQL status: SELECT 2 in 0.02 seconds
[0m04:28:33.904000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f41005f-6566-4677-a593-83f07586d61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDD88B7F0>]}
[0m04:28:33.904558 [debug] [MainThread]: On master: ROLLBACK
[0m04:28:33.905594 [debug] [MainThread]: Using postgres connection "master"
[0m04:28:33.906115 [debug] [MainThread]: On master: BEGIN
[0m04:28:33.907680 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:28:33.907680 [debug] [MainThread]: On master: COMMIT
[0m04:28:33.908195 [debug] [MainThread]: Using postgres connection "master"
[0m04:28:33.908195 [debug] [MainThread]: On master: COMMIT
[0m04:28:33.909743 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:28:33.910273 [debug] [MainThread]: On master: Close
[0m04:28:33.910805 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:28:33.911333 [info ] [MainThread]: 
[0m04:28:33.919044 [debug] [Thread-1 (]: Began running node model.demo_dbt.my_first_dbt_model
[0m04:28:33.919545 [info ] [Thread-1 (]: 1 of 3 START sql table model mes.my_first_dbt_model ............................ [RUN]
[0m04:28:33.920562 [debug] [Thread-1 (]: Acquiring new postgres connection "model.demo_dbt.my_first_dbt_model"
[0m04:28:33.920562 [debug] [Thread-1 (]: Began compiling node model.demo_dbt.my_first_dbt_model
[0m04:28:33.921046 [debug] [Thread-1 (]: Compiling model.demo_dbt.my_first_dbt_model
[0m04:28:33.923063 [debug] [Thread-1 (]: Writing injected SQL for node "model.demo_dbt.my_first_dbt_model"
[0m04:28:33.924122 [debug] [Thread-1 (]: finished collecting timing info
[0m04:28:33.924627 [debug] [Thread-1 (]: Began executing node model.demo_dbt.my_first_dbt_model
[0m04:28:33.958313 [debug] [Thread-1 (]: Writing runtime sql for node "model.demo_dbt.my_first_dbt_model"
[0m04:28:33.960240 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m04:28:33.960240 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: BEGIN
[0m04:28:33.960240 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:28:34.002965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m04:28:34.003482 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m04:28:34.003482 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */

  
    

  create  table "stage"."mes"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m04:28:34.074508 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.07 seconds
[0m04:28:34.080004 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m04:28:34.080528 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "stage"."mes"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m04:28:34.084179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:28:34.086929 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m04:28:34.086929 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
alter table "stage"."mes"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m04:28:34.089015 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:28:34.107503 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: COMMIT
[0m04:28:34.107503 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m04:28:34.107503 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: COMMIT
[0m04:28:34.120096 [debug] [Thread-1 (]: SQL status: COMMIT in 0.01 seconds
[0m04:28:34.124381 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_first_dbt_model"
[0m04:28:34.124897 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_first_dbt_model"} */
drop table if exists "stage"."mes"."my_first_dbt_model__dbt_backup" cascade
[0m04:28:34.144758 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.02 seconds
[0m04:28:34.145816 [debug] [Thread-1 (]: finished collecting timing info
[0m04:28:34.146367 [debug] [Thread-1 (]: On model.demo_dbt.my_first_dbt_model: Close
[0m04:28:34.146894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f41005f-6566-4677-a593-83f07586d61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDD8D16F0>]}
[0m04:28:34.147458 [info ] [Thread-1 (]: 1 of 3 OK created sql table model mes.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.23s]
[0m04:28:34.148964 [debug] [Thread-1 (]: Finished running node model.demo_dbt.my_first_dbt_model
[0m04:28:34.148964 [debug] [Thread-1 (]: Began running node model.demo_dbt.pg_sample_data_mes
[0m04:28:34.149997 [info ] [Thread-1 (]: 2 of 3 START sql table model mes.pg_sample_data_mes ............................ [RUN]
[0m04:28:34.150996 [debug] [Thread-1 (]: Acquiring new postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m04:28:34.151372 [debug] [Thread-1 (]: Began compiling node model.demo_dbt.pg_sample_data_mes
[0m04:28:34.151495 [debug] [Thread-1 (]: Compiling model.demo_dbt.pg_sample_data_mes
[0m04:28:34.154012 [debug] [Thread-1 (]: Writing injected SQL for node "model.demo_dbt.pg_sample_data_mes"
[0m04:28:34.154994 [debug] [Thread-1 (]: finished collecting timing info
[0m04:28:34.155495 [debug] [Thread-1 (]: Began executing node model.demo_dbt.pg_sample_data_mes
[0m04:28:34.158512 [debug] [Thread-1 (]: Writing runtime sql for node "model.demo_dbt.pg_sample_data_mes"
[0m04:28:34.159495 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m04:28:34.159996 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: BEGIN
[0m04:28:34.159996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:28:34.204857 [debug] [Thread-1 (]: SQL status: BEGIN in 0.04 seconds
[0m04:28:34.204857 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m04:28:34.205376 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.pg_sample_data_mes"} */

  
    

  create  table "stage"."mes"."pg_sample_data_mes__dbt_tmp"
  as (
    with dataserver_data as (
    select * from "stage"."mes"."dataserver_data"
    where dic_dataservers_id = 2
),

final as (
select * from dataserver_data
)

select * from final
  );
  
[0m04:28:34.246248 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.04 seconds
[0m04:28:34.248869 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m04:28:34.249389 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.pg_sample_data_mes"} */
alter table "stage"."mes"."pg_sample_data_mes" rename to "pg_sample_data_mes__dbt_backup"
[0m04:28:34.251624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:28:34.253624 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m04:28:34.254124 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.pg_sample_data_mes"} */
alter table "stage"."mes"."pg_sample_data_mes__dbt_tmp" rename to "pg_sample_data_mes"
[0m04:28:34.255624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:28:34.257645 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: COMMIT
[0m04:28:34.258123 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m04:28:34.258123 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: COMMIT
[0m04:28:34.263622 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:28:34.265625 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.pg_sample_data_mes"
[0m04:28:34.265625 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.pg_sample_data_mes"} */
drop view if exists "stage"."mes"."pg_sample_data_mes__dbt_backup" cascade
[0m04:28:34.270419 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:28:34.272567 [debug] [Thread-1 (]: finished collecting timing info
[0m04:28:34.272567 [debug] [Thread-1 (]: On model.demo_dbt.pg_sample_data_mes: Close
[0m04:28:34.273571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f41005f-6566-4677-a593-83f07586d61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDDA94B50>]}
[0m04:28:34.273849 [info ] [Thread-1 (]: 2 of 3 OK created sql table model mes.pg_sample_data_mes ....................... [[32mSELECT 1[0m in 0.12s]
[0m04:28:34.274848 [debug] [Thread-1 (]: Finished running node model.demo_dbt.pg_sample_data_mes
[0m04:28:34.274848 [debug] [Thread-1 (]: Began running node model.demo_dbt.my_second_dbt_model
[0m04:28:34.275348 [info ] [Thread-1 (]: 3 of 3 START sql view model mes.my_second_dbt_model ............................ [RUN]
[0m04:28:34.276348 [debug] [Thread-1 (]: Acquiring new postgres connection "model.demo_dbt.my_second_dbt_model"
[0m04:28:34.276848 [debug] [Thread-1 (]: Began compiling node model.demo_dbt.my_second_dbt_model
[0m04:28:34.277172 [debug] [Thread-1 (]: Compiling model.demo_dbt.my_second_dbt_model
[0m04:28:34.279366 [debug] [Thread-1 (]: Writing injected SQL for node "model.demo_dbt.my_second_dbt_model"
[0m04:28:34.280348 [debug] [Thread-1 (]: finished collecting timing info
[0m04:28:34.280848 [debug] [Thread-1 (]: Began executing node model.demo_dbt.my_second_dbt_model
[0m04:28:34.296689 [debug] [Thread-1 (]: Writing runtime sql for node "model.demo_dbt.my_second_dbt_model"
[0m04:28:34.298422 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m04:28:34.298422 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: BEGIN
[0m04:28:34.298422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:28:34.348906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.05 seconds
[0m04:28:34.349430 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m04:28:34.350048 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */

  create view "stage"."mes"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "stage"."mes"."my_first_dbt_model"
where id = 1
  );
[0m04:28:34.363747 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.01 seconds
[0m04:28:34.366394 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m04:28:34.367022 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
alter table "stage"."mes"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m04:28:34.368879 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:28:34.370876 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: COMMIT
[0m04:28:34.370876 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m04:28:34.371375 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: COMMIT
[0m04:28:34.374376 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:28:34.376379 [debug] [Thread-1 (]: Using postgres connection "model.demo_dbt.my_second_dbt_model"
[0m04:28:34.376879 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "demo_dbt", "target_name": "dev", "node_id": "model.demo_dbt.my_second_dbt_model"} */
drop view if exists "stage"."mes"."my_second_dbt_model__dbt_backup" cascade
[0m04:28:34.378378 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:28:34.379879 [debug] [Thread-1 (]: finished collecting timing info
[0m04:28:34.379879 [debug] [Thread-1 (]: On model.demo_dbt.my_second_dbt_model: Close
[0m04:28:34.380877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f41005f-6566-4677-a593-83f07586d61f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDDA8E5C0>]}
[0m04:28:34.381378 [info ] [Thread-1 (]: 3 of 3 OK created sql view model mes.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.11s]
[0m04:28:34.382374 [debug] [Thread-1 (]: Finished running node model.demo_dbt.my_second_dbt_model
[0m04:28:34.383875 [debug] [MainThread]: Acquiring new postgres connection "master"
[0m04:28:34.384376 [debug] [MainThread]: Using postgres connection "master"
[0m04:28:34.384376 [debug] [MainThread]: On master: BEGIN
[0m04:28:34.384879 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:28:34.416449 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m04:28:34.416948 [debug] [MainThread]: On master: COMMIT
[0m04:28:34.417519 [debug] [MainThread]: Using postgres connection "master"
[0m04:28:34.417519 [debug] [MainThread]: On master: COMMIT
[0m04:28:34.418950 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:28:34.419447 [debug] [MainThread]: On master: Close
[0m04:28:34.419948 [info ] [MainThread]: 
[0m04:28:34.420448 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m04:28:34.420968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:28:34.421449 [debug] [MainThread]: Connection 'list_stage' was properly closed.
[0m04:28:34.421449 [debug] [MainThread]: Connection 'list_stage_mes' was properly closed.
[0m04:28:34.421449 [debug] [MainThread]: Connection 'model.demo_dbt.my_second_dbt_model' was properly closed.
[0m04:28:34.428110 [info ] [MainThread]: 
[0m04:28:34.429111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:28:34.429611 [info ] [MainThread]: 
[0m04:28:34.430109 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m04:28:34.430109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDD8889D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDD7E78E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACDD78BF70>]}
[0m04:28:34.430610 [debug] [MainThread]: Flushing usage events
